# Set the name of the workflow
name: Deploy to Azure App Service

# Set the events that will trigger the workflow
on:
  push:
    branches:
      - main

# Define the jobs to be run in the workflow
jobs:
  # Set the name of the job
  deploy:
    # Set the type of the job to be a deployment
    type: deploy
    # Set the provider to be Azure
    provider: azure
    # Set the name of the Azure subscription
    subscription: Azure subscription 1
    # Set the Azure subscription key
    key: ${{ secrets.AZURE_SUBSCRIPTION_KEY }}
    # Set the name of the Azure resource group where the App Service is located
    resource_group: kmq-ngen-tlp-frontend
    # Set the name of the Azure App Service where the code will be deployed
    app_service: kmq-ngen-tlp-wordpress
    # Set the directory on the Azure App Service where the code will be deployed
    directory: /site/wwwroot/wp-content/themes/test-theme

    # Define the steps to be run in the job
    steps:
      # Install Node.js
      - uses: actions/setup-node@v1
        with:
          node-version: 12

      # Run `npm install` to install dependencies
      - run: npm install

      # Run `npm run build` to build the code
      - run: npm run build